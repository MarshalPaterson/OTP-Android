version: 2.1

    orbs:
    android: "1.0.3"

workflows:
    test-and-build:
    jobs:
    - unit-test
    - android-test: # Commits to any branch - skip matrix of devices
    filters:
    branches:
    ignore: main
    - android-test: # Commits to main branch only - run full matrix
    matrix:
    alias: android-test-all
    parameters:
    system-image:
    - system-images;android-30;google_apis;x86
    name: android-test-<<matrix.system-image>>
filters:
branches:
only: main
- release-build:
requires:
- unit-test
- android-test-all
filters:
branches:
only: main # Commits to main branch
